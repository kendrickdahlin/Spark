Spark Executor Command: "/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java" "-cp" "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/conf/:/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/jars/*" "-Xmx1024M" "-Dspark.driver.port=59917" "-Djava.net.preferIPv6Addresses=false" "-XX:+IgnoreUnrecognizedVMOptions" "--add-opens=java.base/java.lang=ALL-UNNAMED" "--add-opens=java.base/java.lang.invoke=ALL-UNNAMED" "--add-opens=java.base/java.lang.reflect=ALL-UNNAMED" "--add-opens=java.base/java.io=ALL-UNNAMED" "--add-opens=java.base/java.net=ALL-UNNAMED" "--add-opens=java.base/java.nio=ALL-UNNAMED" "--add-opens=java.base/java.util=ALL-UNNAMED" "--add-opens=java.base/java.util.concurrent=ALL-UNNAMED" "--add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED" "--add-opens=java.base/sun.nio.ch=ALL-UNNAMED" "--add-opens=java.base/sun.nio.cs=ALL-UNNAMED" "--add-opens=java.base/sun.security.action=ALL-UNNAMED" "--add-opens=java.base/sun.util.calendar=ALL-UNNAMED" "--add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED" "-Djdk.reflect.useDirectMethodHandle=false" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@dyn230-001.wireless-1725.ndsu.nodak.edu:59917" "--executor-id" "0" "--hostname" "172.25.230.1" "--cores" "8" "--app-id" "app-20240508110641-0007" "--worker-url" "spark://Worker@172.25.230.1:59674" "--resourceProfileId" "0"
========================================

Using Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties
24/05/08 11:06:43 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 22796@dyn230-001.wireless-1725.ndsu.NoDak.edu
24/05/08 11:06:43 INFO SignalUtils: Registering signal handler for TERM
24/05/08 11:06:43 INFO SignalUtils: Registering signal handler for HUP
24/05/08 11:06:43 INFO SignalUtils: Registering signal handler for INT
24/05/08 11:06:44 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
24/05/08 11:06:44 INFO SecurityManager: Changing view acls to: aaronmackenzie
24/05/08 11:06:44 INFO SecurityManager: Changing modify acls to: aaronmackenzie
24/05/08 11:06:44 INFO SecurityManager: Changing view acls groups to: 
24/05/08 11:06:44 INFO SecurityManager: Changing modify acls groups to: 
24/05/08 11:06:44 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: aaronmackenzie; groups with view permissions: EMPTY; users with modify permissions: aaronmackenzie; groups with modify permissions: EMPTY
24/05/08 11:06:44 INFO TransportClientFactory: Successfully created connection to dyn230-001.wireless-1725.ndsu.NoDak.edu/172.25.230.1:59917 after 80 ms (0 ms spent in bootstraps)
24/05/08 11:06:44 INFO SecurityManager: Changing view acls to: aaronmackenzie
24/05/08 11:06:44 INFO SecurityManager: Changing modify acls to: aaronmackenzie
24/05/08 11:06:44 INFO SecurityManager: Changing view acls groups to: 
24/05/08 11:06:44 INFO SecurityManager: Changing modify acls groups to: 
24/05/08 11:06:44 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: aaronmackenzie; groups with view permissions: EMPTY; users with modify permissions: aaronmackenzie; groups with modify permissions: EMPTY
24/05/08 11:06:44 INFO TransportClientFactory: Successfully created connection to dyn230-001.wireless-1725.ndsu.NoDak.edu/172.25.230.1:59917 after 2 ms (0 ms spent in bootstraps)
24/05/08 11:06:44 INFO DiskBlockManager: Created local directory at /private/var/folders/rh/d6ltsplj4f94dtzy8y9sz6lr0000gn/T/spark-015f1d75-d80c-42c8-95d8-a26144992d9f/executor-53e833dc-8236-48e1-b825-dd65d2e6930d/blockmgr-13a81ca5-4908-4e24-abcb-232416a78abd
24/05/08 11:06:44 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
24/05/08 11:06:45 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@dyn230-001.wireless-1725.ndsu.nodak.edu:59917
24/05/08 11:06:45 INFO WorkerWatcher: Connecting to worker spark://Worker@172.25.230.1:59674
24/05/08 11:06:45 INFO TransportClientFactory: Successfully created connection to /172.25.230.1:59674 after 8 ms (0 ms spent in bootstraps)
24/05/08 11:06:45 INFO WorkerWatcher: Successfully connected to spark://Worker@172.25.230.1:59674
24/05/08 11:06:45 INFO ResourceUtils: ==============================================================
24/05/08 11:06:45 INFO ResourceUtils: No custom resources configured for spark.executor.
24/05/08 11:06:45 INFO ResourceUtils: ==============================================================
24/05/08 11:06:45 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
24/05/08 11:06:45 INFO Executor: Starting executor ID 0 on host 172.25.230.1
24/05/08 11:06:45 INFO Executor: OS info Mac OS X, 14.4.1, x86_64
24/05/08 11:06:45 INFO Executor: Java version 1.8.0_401
24/05/08 11:06:45 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 59925.
24/05/08 11:06:45 INFO NettyBlockTransferService: Server created on 172.25.230.1:59925
24/05/08 11:06:45 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
24/05/08 11:06:45 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(0, 172.25.230.1, 59925, None)
24/05/08 11:06:45 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(0, 172.25.230.1, 59925, None)
24/05/08 11:06:45 INFO BlockManager: Initialized BlockManager: BlockManagerId(0, 172.25.230.1, 59925, None)
24/05/08 11:06:45 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
24/05/08 11:06:45 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@7fb9d8a7 for default.
24/05/08 11:06:48 INFO CoarseGrainedExecutorBackend: Got assigned task 0
24/05/08 11:06:48 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
24/05/08 11:06:48 INFO TorrentBroadcast: Started reading broadcast variable 1 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:48 INFO TransportClientFactory: Successfully created connection to dyn230-001.wireless-1725.ndsu.NoDak.edu/172.25.230.1:59920 after 4 ms (0 ms spent in bootstraps)
24/05/08 11:06:48 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 366.3 MiB)
24/05/08 11:06:48 INFO TorrentBroadcast: Reading broadcast variable 1 took 149 ms
24/05/08 11:06:48 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 366.3 MiB)
24/05/08 11:06:49 INFO CodeGenerator: Code generated in 310.698333 ms
24/05/08 11:06:49 INFO FileScanRDD: Reading File path: file:///opt/homebrew/Cellar/apache-spark/3.5.0/libexec/4Cluster2Ddataset.csv, range: 0-19230, partition values: [empty row]
24/05/08 11:06:49 INFO CodeGenerator: Code generated in 31.437208 ms
24/05/08 11:06:49 INFO TorrentBroadcast: Started reading broadcast variable 0 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:49 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 366.2 MiB)
24/05/08 11:06:49 INFO TorrentBroadcast: Reading broadcast variable 0 took 25 ms
24/05/08 11:06:50 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 519.0 KiB, free 365.7 MiB)
24/05/08 11:06:50 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1671 bytes result sent to driver
24/05/08 11:06:50 INFO CoarseGrainedExecutorBackend: Got assigned task 1
24/05/08 11:06:50 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
24/05/08 11:06:50 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:50 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.7 KiB, free 365.7 MiB)
24/05/08 11:06:50 INFO TorrentBroadcast: Reading broadcast variable 3 took 36 ms
24/05/08 11:06:50 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.4 KiB, free 365.7 MiB)
24/05/08 11:06:52 INFO CodeGenerator: Code generated in 35.605917 ms
24/05/08 11:06:52 INFO FileScanRDD: Reading File path: file:///opt/homebrew/Cellar/apache-spark/3.5.0/libexec/4Cluster2Ddataset.csv, range: 0-19230, partition values: [empty row]
24/05/08 11:06:52 INFO TorrentBroadcast: Started reading broadcast variable 2 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 365.7 MiB)
24/05/08 11:06:52 INFO TorrentBroadcast: Reading broadcast variable 2 took 27 ms
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 519.0 KiB, free 365.2 MiB)
24/05/08 11:06:52 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1658 bytes result sent to driver
24/05/08 11:06:52 INFO CoarseGrainedExecutorBackend: Got assigned task 2
24/05/08 11:06:52 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
24/05/08 11:06:52 INFO TorrentBroadcast: Started reading broadcast variable 5 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 6.2 KiB, free 365.2 MiB)
24/05/08 11:06:52 INFO TorrentBroadcast: Reading broadcast variable 5 took 22 ms
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 11.9 KiB, free 365.1 MiB)
24/05/08 11:06:52 INFO FileScanRDD: Reading File path: file:///opt/homebrew/Cellar/apache-spark/3.5.0/libexec/4Cluster2Ddataset.csv, range: 0-19230, partition values: [empty row]
24/05/08 11:06:52 INFO CodeGenerator: Code generated in 26.189875 ms
24/05/08 11:06:52 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.4 KiB, free 365.1 MiB)
24/05/08 11:06:52 INFO TorrentBroadcast: Reading broadcast variable 4 took 20 ms
24/05/08 11:06:52 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 519.0 KiB, free 364.6 MiB)
24/05/08 11:06:53 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 11588 bytes result sent to driver
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 3
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 4
24/05/08 11:06:53 INFO Executor: Running task 0.0 in stage 3.0 (TID 3)
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 5
24/05/08 11:06:53 INFO Executor: Running task 1.0 in stage 3.0 (TID 4)
24/05/08 11:06:53 INFO Executor: Running task 2.0 in stage 3.0 (TID 5)
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 6
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 7
24/05/08 11:06:53 INFO Executor: Running task 4.0 in stage 3.0 (TID 7)
24/05/08 11:06:53 INFO Executor: Running task 3.0 in stage 3.0 (TID 6)
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 8
24/05/08 11:06:53 INFO Executor: Running task 5.0 in stage 3.0 (TID 8)
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 9
24/05/08 11:06:53 INFO Executor: Running task 6.0 in stage 3.0 (TID 9)
24/05/08 11:06:53 INFO CoarseGrainedExecutorBackend: Got assigned task 10
24/05/08 11:06:53 INFO Executor: Running task 7.0 in stage 3.0 (TID 10)
24/05/08 11:06:53 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:53 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.6 MiB)
24/05/08 11:06:53 INFO TorrentBroadcast: Reading broadcast variable 6 took 30 ms
24/05/08 11:06:53 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 11.5 KiB, free 364.6 MiB)
Centroid found by core for label A: [77.55986562383472, 31.978150988718603]
24/05/08 11:06:54 ERROR Executor: Exception in task 2.0 in stage 3.0 (TID 5)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 112, in <lambda>
    centroid_A = dataset_rdd.filter(lambda row: row['Class'] == 'A').mapPartitions(lambda partition: [PSO(partition, 'A')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
24/05/08 11:06:54 ERROR Executor: Exception in task 4.0 in stage 3.0 (TID 7)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 112, in <lambda>
    centroid_A = dataset_rdd.filter(lambda row: row['Class'] == 'A').mapPartitions(lambda partition: [PSO(partition, 'A')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Centroid found by core for label A: [76.31487583924587, 36.62469821036126]
Centroid found by core for label A: [67.79318069646006, 31.898134936111518]
Centroid found by core for label A: [64.69368410276464, 35.49107920941999]
Centroid found by core for label A: [68.97870331259134, 30.80062370198644]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 703, boot = 412, init = 222, finish = 69
24/05/08 11:06:54 INFO PythonRunner: Times: total = 725, boot = 416, init = 223, finish = 86
24/05/08 11:06:54 INFO PythonRunner: Times: total = 715, boot = 444, init = 207, finish = 64
24/05/08 11:06:54 INFO PythonRunner: Times: total = 690, boot = 436, init = 202, finish = 52
24/05/08 11:06:54 INFO PythonRunner: Times: total = 735, boot = 422, init = 245, finish = 68
Centroid found by core for label A: [66.28537941393583, 32.66412757993164]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 752, boot = 433, init = 226, finish = 93
24/05/08 11:06:54 INFO Executor: Finished task 1.0 in stage 3.0 (TID 4). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 3.0 in stage 3.0 (TID 6). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 6.0 in stage 3.0 (TID 9). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 7.0 in stage 3.0 (TID 10). 1343 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 0.0 in stage 3.0 (TID 3). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 5.0 in stage 3.0 (TID 8). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 11
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 12
24/05/08 11:06:54 INFO Executor: Running task 2.1 in stage 3.0 (TID 11)
24/05/08 11:06:54 INFO Executor: Running task 4.1 in stage 3.0 (TID 12)
Centroid found by core for label A: [73.84933053720452, 23.95452693638718]
Centroid found by core for label A: [67.41520517420707, 28.9566123464493]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 97, boot = -227, init = 268, finish = 56
24/05/08 11:06:54 INFO PythonRunner: Times: total = 95, boot = -260, init = 301, finish = 54
24/05/08 11:06:54 INFO Executor: Finished task 4.1 in stage 3.0 (TID 12). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 2.1 in stage 3.0 (TID 11). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 13
24/05/08 11:06:54 INFO Executor: Running task 0.0 in stage 4.0 (TID 13)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 14
24/05/08 11:06:54 INFO Executor: Running task 1.0 in stage 4.0 (TID 14)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 15
24/05/08 11:06:54 INFO Executor: Running task 2.0 in stage 4.0 (TID 15)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 16
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 17
24/05/08 11:06:54 INFO Executor: Running task 3.0 in stage 4.0 (TID 16)
24/05/08 11:06:54 INFO Executor: Running task 4.0 in stage 4.0 (TID 17)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 18
24/05/08 11:06:54 INFO Executor: Running task 5.0 in stage 4.0 (TID 18)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 19
24/05/08 11:06:54 INFO Executor: Running task 6.0 in stage 4.0 (TID 19)
24/05/08 11:06:54 INFO TorrentBroadcast: Started reading broadcast variable 7 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 20
24/05/08 11:06:54 INFO Executor: Running task 7.0 in stage 4.0 (TID 20)
24/05/08 11:06:54 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.6 MiB)
24/05/08 11:06:54 INFO TorrentBroadcast: Reading broadcast variable 7 took 31 ms
24/05/08 11:06:54 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 11.5 KiB, free 364.6 MiB)
24/05/08 11:06:54 ERROR Executor: Exception in task 3.0 in stage 4.0 (TID 16)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 115, in <lambda>
    centroid_B = dataset_rdd.filter(lambda row: row['Class'] == 'B').mapPartitions(lambda partition: [PSO(partition, 'B')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
24/05/08 11:06:54 ERROR Executor: Exception in task 6.0 in stage 4.0 (TID 19)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 115, in <lambda>
    centroid_B = dataset_rdd.filter(lambda row: row['Class'] == 'B').mapPartitions(lambda partition: [PSO(partition, 'B')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
24/05/08 11:06:54 ERROR Executor: Exception in task 0.0 in stage 4.0 (TID 13)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 115, in <lambda>
    centroid_B = dataset_rdd.filter(lambda row: row['Class'] == 'B').mapPartitions(lambda partition: [PSO(partition, 'B')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Centroid found by core for label B: [64.94947486899137, 66.53368985665456]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 151, boot = -489, init = 534, finish = 106
Centroid found by core for label B: [68.81319837168107, 72.19457085492478]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 173, boot = -508, init = 553, finish = 128
Centroid found by core for label B: [67.44908010097862, 77.42082425145826]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 170, boot = -214, init = 282, finish = 102
24/05/08 11:06:54 INFO Executor: Finished task 5.0 in stage 4.0 (TID 18). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 2.0 in stage 4.0 (TID 15). 1386 bytes result sent to driver
Centroid found by core for label B: [65.5882213720425, 77.99443964171004]
Centroid found by core for label B: [72.42849927709447, 67.65751444345301]
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 21
24/05/08 11:06:54 INFO PythonRunner: Times: total = 195, boot = 18, init = 122, finish = 55
24/05/08 11:06:54 INFO Executor: Finished task 4.0 in stage 4.0 (TID 17). 1386 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Running task 6.1 in stage 4.0 (TID 21)
24/05/08 11:06:54 INFO PythonRunner: Times: total = 197, boot = 31, init = 109, finish = 57
24/05/08 11:06:54 INFO Executor: Finished task 7.0 in stage 4.0 (TID 20). 1343 bytes result sent to driver
24/05/08 11:06:54 INFO Executor: Finished task 1.0 in stage 4.0 (TID 14). 1343 bytes result sent to driver
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 22
24/05/08 11:06:54 INFO Executor: Running task 3.1 in stage 4.0 (TID 22)
24/05/08 11:06:54 INFO CoarseGrainedExecutorBackend: Got assigned task 23
24/05/08 11:06:54 INFO Executor: Running task 0.1 in stage 4.0 (TID 23)
Centroid found by core for label B: [76.38785609638111, 67.37510294654967]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 105, boot = -76, init = 118, finish = 63
Centroid found by core for label B: [72.36897522097453, 67.75362328346223]
24/05/08 11:06:54 INFO PythonRunner: Times: total = 130, boot = -99, init = 144, finish = 85
24/05/08 11:06:55 INFO Executor: Finished task 6.1 in stage 4.0 (TID 21). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 3.1 in stage 4.0 (TID 22). 1386 bytes result sent to driver
Centroid found by core for label B: [69.41935832174062, 76.81432180268229]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 134, boot = -83, init = 127, finish = 90
24/05/08 11:06:55 INFO Executor: Finished task 0.1 in stage 4.0 (TID 23). 1343 bytes result sent to driver
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 24
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 25
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 26
24/05/08 11:06:55 INFO Executor: Running task 1.0 in stage 5.0 (TID 25)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 27
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 28
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 29
24/05/08 11:06:55 INFO Executor: Running task 3.0 in stage 5.0 (TID 27)
24/05/08 11:06:55 INFO Executor: Running task 5.0 in stage 5.0 (TID 29)
24/05/08 11:06:55 INFO Executor: Running task 4.0 in stage 5.0 (TID 28)
24/05/08 11:06:55 INFO Executor: Running task 0.0 in stage 5.0 (TID 24)
24/05/08 11:06:55 INFO Executor: Running task 2.0 in stage 5.0 (TID 26)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 30
24/05/08 11:06:55 INFO Executor: Running task 6.0 in stage 5.0 (TID 30)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 31
24/05/08 11:06:55 INFO Executor: Running task 7.0 in stage 5.0 (TID 31)
24/05/08 11:06:55 INFO TorrentBroadcast: Started reading broadcast variable 8 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:55 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.6 MiB)
24/05/08 11:06:55 INFO TorrentBroadcast: Reading broadcast variable 8 took 62 ms
24/05/08 11:06:55 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 11.5 KiB, free 364.5 MiB)
Centroid found by core for label C: [33.200724851664084, 37.49412502843643]
24/05/08 11:06:55 ERROR Executor: Exception in task 0.0 in stage 5.0 (TID 24)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 118, in <lambda>
    centroid_C = dataset_rdd.filter(lambda row: row['Class'] == 'C').mapPartitions(lambda partition: [PSO(partition, 'C')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 46, in PSO
    gbest_position = [float(row[0]), float(row[1])]
                            ~~~^^^
IndexError: list index out of range

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Centroid found by core for label C: [28.70310066573624, 30.39920930020751]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 171, boot = -278, init = 354, finish = 95
24/05/08 11:06:55 INFO PythonRunner: Times: total = 182, boot = -217, init = 271, finish = 128
Centroid found by core for label C: [39.02193161903517, 30.945096577930684]
Centroid found by core for label C: [26.393277192784605, 25.42337330145939]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 198, boot = -423, init = 480, finish = 141
24/05/08 11:06:55 INFO PythonRunner: Times: total = 198, boot = -300, init = 393, finish = 105
Centroid found by core for label C: [27.889817316734984, 28.283154027136717]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 202, boot = 15, init = 118, finish = 69
24/05/08 11:06:55 INFO Executor: Finished task 4.0 in stage 5.0 (TID 28). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 7.0 in stage 5.0 (TID 31). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 5.0 in stage 5.0 (TID 29). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 1.0 in stage 5.0 (TID 25). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 6.0 in stage 5.0 (TID 30). 1343 bytes result sent to driver
Centroid found by core for label C: [33.59543965663623, 34.36284604073872]
Centroid found by core for label C: [23.845384759830097, 31.71866357175032]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 227, boot = -427, init = 502, finish = 152
24/05/08 11:06:55 INFO PythonRunner: Times: total = 224, boot = 45, init = 111, finish = 68
24/05/08 11:06:55 INFO Executor: Finished task 2.0 in stage 5.0 (TID 26). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO Executor: Finished task 3.0 in stage 5.0 (TID 27). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 32
24/05/08 11:06:55 INFO Executor: Running task 0.1 in stage 5.0 (TID 32)
Centroid found by core for label C: [32.11205941022017, 31.395365035687725]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 86, boot = -98, init = 137, finish = 47
24/05/08 11:06:55 INFO Executor: Finished task 0.1 in stage 5.0 (TID 32). 1386 bytes result sent to driver
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 33
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 34
24/05/08 11:06:55 INFO Executor: Running task 1.0 in stage 6.0 (TID 34)
24/05/08 11:06:55 INFO Executor: Running task 0.0 in stage 6.0 (TID 33)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 35
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 36
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 37
24/05/08 11:06:55 INFO Executor: Running task 3.0 in stage 6.0 (TID 36)
24/05/08 11:06:55 INFO Executor: Running task 4.0 in stage 6.0 (TID 37)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 38
24/05/08 11:06:55 INFO Executor: Running task 5.0 in stage 6.0 (TID 38)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 39
24/05/08 11:06:55 INFO Executor: Running task 2.0 in stage 6.0 (TID 35)
24/05/08 11:06:55 INFO CoarseGrainedExecutorBackend: Got assigned task 40
24/05/08 11:06:55 INFO Executor: Running task 6.0 in stage 6.0 (TID 39)
24/05/08 11:06:55 INFO Executor: Running task 7.0 in stage 6.0 (TID 40)
24/05/08 11:06:55 INFO TorrentBroadcast: Started reading broadcast variable 9 with 1 pieces (estimated total size 4.0 MiB)
24/05/08 11:06:55 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 7.0 KiB, free 364.5 MiB)
24/05/08 11:06:55 INFO TorrentBroadcast: Reading broadcast variable 9 took 61 ms
24/05/08 11:06:55 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 11.5 KiB, free 364.5 MiB)
Centroid found by core for label D: [29.680413285835815, 61.51553230062739]
Centroid found by core for label D: [26.450003720955063, 62.50820101894449]
Centroid found by core for label D: [31.594497132149666, 69.05016550995002]
Centroid found by core for label D: [26.991442781072507, 65.90323428745117]
24/05/08 11:06:55 INFO PythonRunner: Times: total = 127, boot = -364, init = 430, finish = 61
24/05/08 11:06:55 INFO PythonRunner: Times: total = 152, boot = -358, init = 432, finish = 78
24/05/08 11:06:55 INFO PythonRunner: Times: total = 132, boot = -209, init = 270, finish = 71
24/05/08 11:06:55 INFO PythonRunner: Times: total = 134, boot = -344, init = 406, finish = 72
24/05/08 11:06:55 ERROR Executor: Exception in task 1.0 in stage 6.0 (TID 34)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/Users/aaronmackenzie/anaconda3/lib/python3.11/site-packages/pyspark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 121, in <lambda>
    centroid_D = dataset_rdd.filter(lambda row: row['Class'] == 'D').mapPartitions(lambda partition: [PSO(partition, 'D')]).collect()
                                                                                                      ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/apache-spark/3.5.0/libexec/a.py", line 44, in PSO
    next(reader)  # Skip the header row
    ^^^^^^^^^^^^
StopIteration

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1046)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2438)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Centroid found by core for label D: [27.98971007089706, 66.74026786365624]
24/05/08 11:06:56 INFO PythonRunner: Times: total = 174, boot = -380, init = 448, finish = 106
24/05/08 11:06:56 INFO Executor: Finished task 6.0 in stage 6.0 (TID 39). 1386 bytes result sent to driver
24/05/08 11:06:56 INFO Executor: Finished task 7.0 in stage 6.0 (TID 40). 1386 bytes result sent to driver
24/05/08 11:06:56 INFO Executor: Finished task 3.0 in stage 6.0 (TID 36). 1386 bytes result sent to driver
24/05/08 11:06:56 INFO Executor: Finished task 0.0 in stage 6.0 (TID 33). 1386 bytes result sent to driver
24/05/08 11:06:56 INFO Executor: Finished task 2.0 in stage 6.0 (TID 35). 1386 bytes result sent to driver
Centroid found by core for label D: [33.4366831496986, 71.18081174322353]
24/05/08 11:06:56 INFO PythonRunner: Times: total = 198, boot = -338, init = 458, finish = 78
24/05/08 11:06:56 INFO Executor: Finished task 4.0 in stage 6.0 (TID 37). 1343 bytes result sent to driver
Centroid found by core for label D: [32.98078401317648, 72.50925383993602]
24/05/08 11:06:56 INFO PythonRunner: Times: total = 178, boot = 17, init = 92, finish = 69
24/05/08 11:06:56 INFO Executor: Finished task 5.0 in stage 6.0 (TID 38). 1343 bytes result sent to driver
24/05/08 11:06:56 INFO CoarseGrainedExecutorBackend: Got assigned task 41
24/05/08 11:06:56 INFO Executor: Running task 1.1 in stage 6.0 (TID 41)
Centroid found by core for label D: [32.574903523876266, 66.80527213051673]
24/05/08 11:06:56 INFO PythonRunner: Times: total = 91, boot = -131, init = 168, finish = 54
24/05/08 11:06:56 INFO Executor: Finished task 1.1 in stage 6.0 (TID 41). 1343 bytes result sent to driver
24/05/08 11:06:56 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
